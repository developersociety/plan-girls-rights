(function(t){function e(e){for(var n,a,r=e[0],c=e[1],l=e[2],p=0,h=[];p<r.length;p++)a=r[p],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(t[n]=c[n]);u&&u(e);while(h.length)h.shift()();return s.push.apply(s,l||[]),i()}function i(){for(var t,e=0;e<s.length;e++){for(var i=s[e],n=!0,r=1;r<i.length;r++){var c=i[r];0!==o[c]&&(n=!1)}n&&(s.splice(e--,1),t=a(a.s=i[0]))}return t}var n={},o={app:0},s=[];function a(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=n,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;s.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";var n=i("85ec"),o=i.n(n);o.a},"0e9d":function(t,e,i){},"12b2":function(t,e,i){"use strict";var n=i("be1a"),o=i.n(n);o.a},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("section",{staticClass:"main"},[i("h1",{staticClass:"title"},[t._v("Lorem ipsum dolor sit amet, consectetur adipiscing elit.")]),i("p",{staticClass:"text"},[t._v("Pellentesque ultricies odio leo, quis sodales augue commodo eget. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Mauris ut facilisis ex. Ut ultrices fringilla rhoncus. Sed tincidunt augue tincidunt, tincidunt sapien luctus, volutpat augue.")]),i("div",{staticClass:"map",attrs:{id:"map"}}),i("div",{staticClass:"search-form"},[i("div",{staticClass:"search"},[i("autocomplete",{attrs:{items:t.locations,maxSuggestions:5,placeholderText:"find a story"},on:{input:t.onLocationChange}})],1),i("button",{staticClass:"btn btn-orange",staticStyle:{"margin-left":"24px"},on:{click:t.filter}},[t._v(" Search ")])]),i("tags-component",{attrs:{tags:t.availableTags},on:{input:t.onTagsChange}})],1),t.itemsToShowInPopUp.length>0?i("popup",{attrs:{items:t.itemsToShowInPopUp,geoJson:t.geoJson,center:t.popupMapCenter},on:{close:function(e){t.itemsToShowInPopUp=[]}}}):t._e()],1)},s=[],a=(i("4de4"),i("c975"),i("d81d"),i("1276"),i("498a"),i("159b"),i("e11e")),r=(i("2573"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tags"},[i("h3",{staticClass:"title"},[t._v(" Filter stories by theme ")]),i("div",{staticClass:"items"},[i("button",{class:{"item-active":t.allSelected,item:!0},attrs:{type:"button"},on:{click:function(e){return t.selectAll()}}},[t._v("All")]),t._l(t.tags,(function(e,n){return i("button",{key:n,class:{"item-active":t.selected.indexOf(e)>=0,item:!0},attrs:{type:"button"},on:{click:function(i){return t.clickOnTag(e)}}},[t._v(" "+t._s(e)+" ")])}))],2)])}),c=[],l=(i("a434"),{name:"tags",props:{tags:Array},data:function(){return{selected:[]}},watch:{selected:function(){this.$emit("input",this.selected)}},computed:{allSelected:function(){return this.selected.length==this.tags.length}},methods:{clickOnTag:function(t){var e=this.selected.indexOf(t);e<0?this.selected.push(t):this.selected.splice(e,1)},selectAll:function(){var t=this;this.allSelected?this.selected=[]:(this.selected=[],this.tags.forEach((function(e){t.selected.push(e)})))}}}),u=l,p=(i("65f01"),i("2877")),h=Object(p["a"])(u,r,c,!1,null,null,null),m=h.exports,d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:"fade"}},[i("div",{staticClass:"popup-container"},[i("div",{staticClass:"close-bl",on:{click:t.close}},[i("span",[t._v("Close")]),i("svg",{staticClass:"close",attrs:{width:"22px",height:"22px",viewBox:"0 0 22 22",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[i("g",{attrs:{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[i("g",{attrs:{id:"Desktop_Story",transform:"translate(-715.000000, -33.000000)",fill:"#FFFFFF","fill-rule":"nonzero"}},[i("g",{attrs:{id:"Overlay"}},[i("g",{attrs:{id:"Close",transform:"translate(706.000000, 24.000000)"}},[i("path",{attrs:{d:"M26.7037037,31 C27.1666667,31 27.6296296,30.8148148 27.962963,30.4814815 L30.4814815,27.962963 C30.8148148,27.6296296 31,27.1666667 31,26.7037037 C31,26.2407407 30.8148148,25.7777778 30.4814815,25.4444444 L25.037037,20 L30.4814815,14.5555556 C30.8148148,14.2222222 31,13.7592593 31,13.2962963 C31,12.8333333 30.8148148,12.3703704 30.4814815,12.037037 L27.962963,9.51851852 C27.6296296,9.18518519 27.1666667,9 26.7037037,9 C26.2407407,9 25.7777778,9.18518519 25.4444444,9.51851852 L20,14.962963 L14.5555556,9.51851852 C14.2222222,9.18518519 13.7592593,9 13.2962963,9 C12.8333333,9 12.3703704,9.18518519 12.037037,9.51851852 L9.51851852,12.037037 C9.18518519,12.3703704 9,12.8333333 9,13.2962963 C9,13.7592593 9.18518519,14.2222222 9.51851852,14.5555556 L14.962963,20 L9.51851852,25.4444444 C9.18518519,25.7777778 9,26.2407407 9,26.7037037 C9,27.1666667 9.18518519,27.6296296 9.51851852,27.962963 L12.037037,30.4814815 C12.3703704,30.8148148 12.8333333,31 13.2962963,31 C13.7592593,31 14.2222222,30.8148148 14.5555556,30.4814815 L20,25.037037 L25.4444444,30.4814815 C25.7777778,30.8148148 26.2407407,31 26.7037037,31 Z"}})])])])])])]),i("div",{staticClass:"modal-map"},[i("div",{attrs:{id:"popup-map"}}),i("div",{staticClass:"transition"},[t.counter>0?i("button",{staticClass:"btn btn-orange btn-transition",on:{click:function(e){t.counter--}}},[t._v(" Previous story ")]):t._e(),i("span",{staticClass:"counter"},[t._v(t._s(t.counter+1)+" of "+t._s(t.items.length))]),t.counter<t.items.length-1?i("button",{staticClass:"btn btn-orange btn-transition",on:{click:function(e){t.counter++}}},[t._v(" next story ")]):t._e()])]),t.item?i("section",{staticClass:"modal"},[i("div",{staticClass:"top"},[i("h1",{staticClass:"title"},[t._v(t._s(t.item.name)+", "+t._s(t.item.age))])]),t.item.youtubeURL?i("div",{staticClass:"video"},[i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"play",on:{click:[function(e){t.visible=!t.visible},t.playVideo]}})]),i("youtube",{ref:"youtube",attrs:{"video-id":t.getId(t.item.youtubeURL),showinfo:"0"}})],1):t._e(),i("img",{staticClass:"photo",attrs:{src:t.item.photoURL,alt:"photo"}}),i("p",{staticClass:"text"},[t._v(t._s(t.item.text))]),i("a",{staticClass:"btn btn-red",attrs:{href:t.item.callToAction.url,target:"_blank"}},[t._v(" "+t._s(t.item.callToAction.text?t.item.callToAction.text:"CTA text")+" ")]),i("div",{staticClass:"tags"},[i("h3",{staticClass:"title"},[t._v("Themes")]),i("div",{staticClass:"items"},t._l(t.themeTags,(function(e,n){return i("button",{key:n,staticClass:"item",attrs:{type:"button"}},[t._v(t._s(e))])})),0)])]):t._e()])])},f=[],g={name:"Popup",props:{items:Array,geoJson:Object,center:Array},data:function(){return{map:void 0,visible:!0,counter:0,marker:void 0}},mounted:function(){this.map=a["map"]("popup-map",{continuousWorld:!0,zoomControl:!1,scrollWheelZoom:!1,static:!0}).setView(this.center?this.center:[53.943,-2.438],7),console.log("geoJson",this.geoJson),a["geoJson"](this.geoJson,{clickable:!0}).addTo(this.map),this.updateMarker()},watch:{center:function(){this.updateMarker()},items:function(){this.updateMarker()}},methods:{updateMarker:function(){this.map&&(this.marker&&this.map.removeLayer(this.marker),this.marker=a["marker"](this.center,{icon:a["divIcon"]({html:"<b>"+this.items.length+"</b>",iconSize:new a["Point"](35,35)})}).addTo(this.map),this.map.panTo(new a["LatLng"](this.center[0],this.center[1])))},getId:function(t){return this.$youtube.getIdFromUrl(t)},playVideo:function(){this.player.playVideo()},stopVideo:function(){this.player.stopVideo()},close:function(){this.$emit("close")}},computed:{player:function(){return this.$refs.youtube.player},item:function(){return this.items[this.counter]?this.items[this.counter]:null},themeTags:function(){return this.item?this.item.themeTags.split(","):[]}}},v=g,C=(i("c32b"),Object(p["a"])(v,d,f,!1,null,"110fbaf6",null)),b=C.exports,y=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],staticClass:"input",attrs:{type:"text",placeholder:t.placeholderText},domProps:{value:t.searchQuery},on:{input:function(e){e.target.composing||(t.searchQuery=e.target.value)}}}),t.suggestions?i("ul",{staticClass:"result"},t._l(t.suggestionsList,(function(e,n){return i("li",{key:n},[i("a",{attrs:{href:"javascript:void(0)"},on:{click:function(i){return t.select(e)}}},[t._v(t._s(e))])])})),0):t._e()])},w=[],x=(i("caad"),i("fb6a"),i("a9e3"),i("2532"),{name:"Autocomplete",props:{items:Array,maxSuggestions:Number,placeholderText:String},data:function(){return{searchQuery:void 0,suggestions:void 0}},watch:{searchQuery:function(t){""==t?(this.suggestions=[],this.$emit("input","")):this.suggestions=this.items.filter((function(e){return e.toLowerCase().includes(t.toLowerCase())}))}},computed:{suggestionsList:function(){return this.suggestions.slice(0,this.maxSuggestions)}},methods:{select:function(t){var e=this;this.searchQuery=t,setTimeout((function(){e.suggestions=[]})),this.$emit("input",t)}}}),T=x,k=(i("12b2"),Object(p["a"])(T,y,w,!1,null,"4b7956d5",null)),_=k.exports,S={name:"app",components:{popup:b,"tags-component":m,autocomplete:_},data:function(){return{config:void 0,equatorLength:40075016.7,zoomRatio:65536,maxZoom:12,isMapResponsive:!0,mapMinWidth:640,geoJson:void 0,map:null,items:[],itemsToShow:[],itemsToShowInPopUp:[],popupMapCenter:void 0,markerClusterGroup:void 0,showModalMap:!1,autocompleteResults:[]}},watch:{itemsToShowInPopUp:function(){console.log("itemsToShowInPopUp",this.itemsToShowInPopUp)},itemsToShow:function(){console.log("itemsToShow Changed",this.itemsToShow),this.showMarkers()}},computed:{availableTags:function(){var t=[];return this.items.forEach((function(e){var i=e.themeTags.split(",");i.forEach((function(e){e=e.trim(),t.indexOf(e)<0&&t.push(e)}))})),t},locations:function(){var t=[];return this.items.forEach((function(e){t.indexOf(e.location)<0&&t.push(e.location)})),t}},mounted:function(){var t=this;this.get("config.json",(function(e){t.config=t.validateJsonString(e),t.config?t.init():alert("Wrong config.json file! Unable to parse JSON!")}))},methods:{onLocationChange:function(t){console.log("onLocationChange",t),this.location=t,this.filter()},onTagsChange:function(t){this.tags=t,this.filter()},filter:function(){var t=this;console.log(this.location,this.tags),this.itemsToShow=this.items.filter((function(e){var i=!0;return i=!t.location||!t.location.length||!(!e.location||e.location!=t.location),i&&t.filterItemByTags(e)}))},filterItemByTags:function(t){var e=this;if(this.tags&&this.tags.length>0){var i=!1,n=t.themeTags.split(",");return n.forEach((function(t){t=t.trim(),e.tags.indexOf(t)>=0&&(i=!0)})),console.log(t.themeTags,this.tags,i),i}return!0},showMarkers:function(){var t=this;if(!this.map)return!1;this.markerClusterGroup&&(this.map.removeLayer(this.markerClusterGroup),this.markerClusterGroup=void 0),this.markerClusterGroup=a["markerClusterGroup"]({iconCreateFunction:function(t){return a["divIcon"]({html:"<b>"+t.getChildCount()+"</b>",iconSize:new a["Point"](35,35)})},singleMarkerMode:!0,spiderfyOnMaxZoom:!1,showCoverageOnHover:!1,zoomToBoundsOnClick:!1}),this.itemsToShow.forEach((function(e){var i=a["marker"]([e.coordinates.lat,e.coordinates.lng],{index:e.index}).on("click",(function(e){if(t.items[e.sourceTarget.options.index]){t.itemsToShowInPopUp=[t.items[e.sourceTarget.options.index]];var i=t.items[e.sourceTarget.options.index].coordinates;t.popupMapCenter=[i.lat,i.lng]}else console.log("wrong index")}));t.markerClusterGroup.addLayer(i)})),this.markerClusterGroup.on("clusterclick",(function(e){var i=e.layer.getAllChildMarkers(),n=[];i.forEach((function(e){t.items[e.options.index]?n.push(t.items[e.options.index]):console.log("wrong index")})),t.itemsToShowInPopUp=n,t.popupMapCenter=[e.latlng.lat,e.latlng.lng]})),this.map.addLayer(this.markerClusterGroup),this.markerClusterGroup.refreshClusters()},init:function(){var t=this;this.get(this.config.geoJSONPath,(function(e){t.geoJson=t.validateJsonString(e),t.geoJson&&(console.log(t.geoJson),t.initMap(),t.itemsToShow=t.items)})),this.get(this.config.apiUrl,(function(e){if(e=t.validateJsonString(e),e)for(var i in t.items=e,t.items)t.items[i].index=i,t.items[i].coordinates=t.getRandomLatLng()}))},initMap:function(){this.map=a["map"]("map",{maxZoom:this.maxZoom,minZoom:0,continuousWorld:!0,scrollWheelZoom:!1,static:!0}).setView([53.943,-2.438],6),a["geoJson"](this.geoJson,{clickable:!0}).addTo(this.map)},getRandomLatLng:function(){return{lat:50.44351305245807+6.728478929685778*Math.random(),lng:14.414062500000004*Math.random()-9.645996093750002}},get:function(t,e){var i=new XMLHttpRequest;i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&200===i.status&&e(i.responseText)},i.open("GET",t,!0),i.send()},validateJsonString:function(t){var e=!1;try{e=JSON.parse(t)}catch(i){return!1}return e}}},L=S,O=(i("034f"),Object(p["a"])(L,o,s,!1,null,null,null)),M=O.exports,P=i("e0ec"),J=i.n(P);n["a"].config.productionTip=!1,n["a"].use(J.a),new n["a"]({render:function(t){return t(M)}}).$mount("#app")},"65f01":function(t,e,i){"use strict";var n=i("f725"),o=i.n(n);o.a},"85ec":function(t,e,i){},be1a:function(t,e,i){},c32b:function(t,e,i){"use strict";var n=i("0e9d"),o=i.n(n);o.a},f725:function(t,e,i){}});
//# sourceMappingURL=app.53677fa0.js.map
