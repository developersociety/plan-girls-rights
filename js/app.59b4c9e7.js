(function(t){function e(e){for(var o,a,r=e[0],c=e[1],l=e[2],h=0,p=[];h<r.length;h++)a=r[h],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&p.push(s[a][0]),s[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,r=1;r<n.length;r++){var c=n[r];0!==s[c]&&(o=!1)}o&&(i.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},s={app:0},i=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("85ec"),s=n.n(o);s.a},"12b2":function(t,e,n){"use strict";var o=n("be1a"),s=n.n(o);s.a},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("section",{staticClass:"main"},[n("h1",{staticClass:"title"},[t._v("Girls’ rights in the UK")]),t._m(0),n("div",{staticClass:"map",attrs:{id:"map"}}),n("div",{staticClass:"search-form"},[n("div",{staticClass:"search"},[n("autocomplete",{attrs:{items:t.locations,maxSuggestions:5,placeholderText:"find a story"},on:{input:t.onLocationChange}})],1),n("button",{staticClass:"btn btn-orange btn-search",on:{click:t.filter}},[t._v(" Search ")])]),n("p",{staticClass:"explain"},[t._v("Text to explain search functionality goes here.")]),n("tags-component",{attrs:{tags:t.availableTags},on:{input:t.onTagsChange}})],1),t.itemsToShowInPopUp.length>0?n("popup",{attrs:{items:t.itemsToShowInPopUp,geoJson:t.geoJson,center:t.popupMapCenter},on:{close:function(e){t.itemsToShowInPopUp=[]}}}):t._e()],1)},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("p",{staticClass:"text"},[t._v(" Across the UK, girls are saying loud and clear that their rights aren’t being met. From street harassment to stereotyping and feeling unsafe at school and online, they’re facing the daily reality of gender inequality in the UK. Explore the map to discover the issues they’ve told us matter the most to them. "),n("b",[t._v("Type in your location to see the stories nearest your area or click a pin on the map to find out more.")])])}],a=(n("4de4"),n("c975"),n("d81d"),n("acd8"),n("1276"),n("498a"),n("159b"),n("e11e")),r=(n("2573"),n("369b")),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tags"},[n("h3",{staticClass:"title"},[t._v(" Filter stories by theme ")]),n("div",{staticClass:"items"},[n("button",{class:{"item-active":t.allSelected,item:!0},attrs:{type:"button"},on:{click:function(e){return t.selectAll()}}},[t._v("All")]),t._l(t.tags,(function(e,o){return n("button",{key:o,class:{"item-active":t.selected.indexOf(e)>=0,item:!0},attrs:{type:"button"},on:{click:function(n){return t.clickOnTag(e)}}},[t._v(" "+t._s(e)+" ")])}))],2)])},l=[],u=(n("a434"),{name:"tags",props:{tags:Array},data:function(){return{selected:[]}},watch:{selected:function(){this.$emit("input",this.selected)}},computed:{allSelected:function(){return this.selected.length==this.tags.length}},methods:{clickOnTag:function(t){var e=this.selected.indexOf(t);e<0?this.selected.push(t):this.selected.splice(e,1)},selectAll:function(){var t=this;this.allSelected?this.selected=[]:(this.selected=[],this.tags.forEach((function(e){t.selected.push(e)})))}}}),h=u,p=(n("65f01"),n("2877")),m=Object(p["a"])(h,c,l,!1,null,null,null),d=m.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"fade"}},[n("div",{staticClass:"popup-container"},[n("div",{staticClass:"close-btn",on:{click:t.close}},[n("span",[t._v("Close")]),n("svg",{staticClass:"close",attrs:{width:"22px",height:"22px",viewBox:"0 0 22 22",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"}},[n("g",{attrs:{id:"Page-1",stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"}},[n("g",{attrs:{id:"Desktop_Story",transform:"translate(-715.000000, -33.000000)",fill:"#FFFFFF","fill-rule":"nonzero"}},[n("g",{attrs:{id:"Overlay"}},[n("g",{attrs:{id:"Close",transform:"translate(706.000000, 24.000000)"}},[n("path",{attrs:{d:"M26.7037037,31 C27.1666667,31 27.6296296,30.8148148 27.962963,30.4814815 L30.4814815,27.962963 C30.8148148,27.6296296 31,27.1666667 31,26.7037037 C31,26.2407407 30.8148148,25.7777778 30.4814815,25.4444444 L25.037037,20 L30.4814815,14.5555556 C30.8148148,14.2222222 31,13.7592593 31,13.2962963 C31,12.8333333 30.8148148,12.3703704 30.4814815,12.037037 L27.962963,9.51851852 C27.6296296,9.18518519 27.1666667,9 26.7037037,9 C26.2407407,9 25.7777778,9.18518519 25.4444444,9.51851852 L20,14.962963 L14.5555556,9.51851852 C14.2222222,9.18518519 13.7592593,9 13.2962963,9 C12.8333333,9 12.3703704,9.18518519 12.037037,9.51851852 L9.51851852,12.037037 C9.18518519,12.3703704 9,12.8333333 9,13.2962963 C9,13.7592593 9.18518519,14.2222222 9.51851852,14.5555556 L14.962963,20 L9.51851852,25.4444444 C9.18518519,25.7777778 9,26.2407407 9,26.7037037 C9,27.1666667 9.18518519,27.6296296 9.51851852,27.962963 L12.037037,30.4814815 C12.3703704,30.8148148 12.8333333,31 13.2962963,31 C13.7592593,31 14.2222222,30.8148148 14.5555556,30.4814815 L20,25.037037 L25.4444444,30.4814815 C25.7777778,30.8148148 26.2407407,31 26.7037037,31 Z"}})])])])])])]),n("div",{staticClass:"modal-map"},[n("div",{attrs:{id:"popup-map"}}),n("div",{staticClass:"transition"},[t.counter>0?n("button",{staticClass:"btn btn-orange btn-transition",on:{click:function(e){t.counter--}}},[n("span",[t._v("Previous")]),t.isMobile?t._e():n("span",[t._v(" story")])]):t._e(),n("span",{staticClass:"counter"},[t._v(t._s(t.counter+1)+" of "+t._s(t.items.length))]),t.counter<t.items.length-1?n("button",{staticClass:"btn btn-orange btn-transition",on:{click:function(e){t.counter++}}},[n("span",[t._v("Next")]),t.isMobile?t._e():n("span",[t._v(" story")])]):t._e()])]),t.item?n("section",{staticClass:"modal"},[n("div",{staticClass:"top"},[n("h1",{staticClass:"title"},[t._v(t._s(t.item.name)+", "+t._s(t.item.age))])]),t.item.youtubeURL?n("div",{staticClass:"video"},[n("transition",{attrs:{name:"fade"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"play",on:{click:[function(e){t.visible=!t.visible},t.playVideo]}})]),n("youtube",{ref:"youtube",attrs:{"video-id":t.getId(t.item.youtubeURL),showinfo:"0"}})],1):t._e(),t.item.photoURL&&t.item.photoURL.length>0?n("img",{staticClass:"photo",attrs:{src:t.item.photoURL,alt:"photo"}}):t._e(),n("p",{staticClass:"text"},[t._v(t._s(t.item.text))]),t.item.callToAction&&t.item.callToAction.text?n("a",{staticClass:"btn btn-red",attrs:{href:t.item.callToAction.url,target:"_blank"}},[t._v(" "+t._s(t.item.callToAction.text)+" ")]):t._e(),n("div",{staticClass:"tags"},[n("h3",{staticClass:"title"},[t._v("Themes")]),n("div",{staticClass:"items"},t._l(t.themeTags,(function(e,o){return n("button",{key:o,staticClass:"item",attrs:{type:"button"}},[t._v(t._s(e))])})),0)])]):t._e()])])},g=[],v={name:"Popup",props:{items:Array,geoJson:Object,center:Array},data:function(){return{map:void 0,visible:!0,counter:0,marker:void 0}},mounted:function(){this.map=a["map"]("popup-map",{continuousWorld:!0,zoomControl:!1,scrollWheelZoom:!1,static:!0}).setView(this.center?this.center:[53.943,-2.438],7),console.log("geoJson",this.geoJson),a["geoJson"](this.geoJson,{clickable:!0}).addTo(this.map),this.updateMarker()},watch:{center:function(){this.updateMarker()},items:function(){this.updateMarker()}},methods:{updateMarker:function(){this.map&&(this.marker&&this.map.removeLayer(this.marker),this.marker=a["marker"](this.center,{icon:a["divIcon"]({html:"<b>"+this.items.length+"</b>",iconSize:new a["Point"](35,35)})}).addTo(this.map),this.map.panTo(new a["LatLng"](this.center[0],this.center[1])))},getId:function(t){return this.$youtube.getIdFromUrl(t)},playVideo:function(){this.player.playVideo()},stopVideo:function(){this.player.stopVideo()},close:function(){this.$emit("close")}},computed:{isMobile:function(){return window.innerWidth<=768},player:function(){return this.$refs.youtube.player},item:function(){return this.items[this.counter]?this.items[this.counter]:null},themeTags:function(){return this.item?this.item.themeTags.split(","):[]}}},b=v,C=(n("e7e9"),Object(p["a"])(b,f,g,!1,null,"2e690b10",null)),y=C.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],staticClass:"input",attrs:{type:"text",placeholder:t.placeholderText},domProps:{value:t.searchQuery},on:{input:function(e){e.target.composing||(t.searchQuery=e.target.value)}}}),t.suggestions?n("ul",{staticClass:"result"},t._l(t.suggestionsList,(function(e,o){return n("li",{key:o},[n("a",{attrs:{href:"javascript:void(0)"},on:{click:function(n){return t.select(e)}}},[t._v(t._s(e))])])})),0):t._e()])},_=[],x=(n("caad"),n("fb6a"),n("a9e3"),n("2532"),{name:"Autocomplete",props:{items:Array,maxSuggestions:Number,placeholderText:String},data:function(){return{searchQuery:void 0,suggestions:void 0}},watch:{searchQuery:function(t){""==t?(this.suggestions=[],this.$emit("input","")):this.suggestions=this.items.filter((function(e){return e.toLowerCase().includes(t.toLowerCase())}))}},computed:{suggestionsList:function(){return this.suggestions.slice(0,this.maxSuggestions)}},methods:{select:function(t){var e=this;this.searchQuery=t,setTimeout((function(){e.suggestions=[]})),this.$emit("input",t)}}}),T=x,k=(n("12b2"),Object(p["a"])(T,w,_,!1,null,"4b7956d5",null)),S=k.exports,L={name:"app",components:{popup:y,"tags-component":d,autocomplete:S},data:function(){return{config:void 0,maxZoom:12,geoJson:void 0,map:null,items:[],itemsToShow:[],itemsToShowInPopUp:[],popupMapCenter:void 0,markerClusterGroup:void 0,showModalMap:!1,autocompleteResults:[]}},watch:{itemsToShowInPopUp:function(){console.log("itemsToShowInPopUp",this.itemsToShowInPopUp)},itemsToShow:function(){console.log("itemsToShow Changed",this.itemsToShow),this.showMarkers()}},computed:{availableTags:function(){var t=[];return this.items.forEach((function(e){var n=e.themeTags.split(",");n.forEach((function(e){e=e.trim(),t.indexOf(e)<0&&t.push(e)}))})),t},locations:function(){var t=[];return this.items.forEach((function(e){t.indexOf(e.location)<0&&t.push(e.location)})),t}},mounted:function(){var t=this;this.get("config.json",(function(e){t.config=t.validateJsonString(e),t.config?t.init():alert("Wrong config.json file! Unable to parse JSON!")}))},methods:{onLocationChange:function(t){console.log("onLocationChange",t),this.location=t,this.filter()},onTagsChange:function(t){this.tags=t,this.filter()},filter:function(){var t=this;console.log(this.location,this.tags),this.itemsToShow=this.items.filter((function(e){var n=!0;return n=!t.location||!t.location.length||!(!e.location||e.location!=t.location),n&&t.filterItemByTags(e)}))},filterItemByTags:function(t){var e=this;if(this.tags&&this.tags.length>0){var n=!1,o=t.themeTags.split(",");return o.forEach((function(t){t=t.trim(),e.tags.indexOf(t)>=0&&(n=!0)})),console.log(t.themeTags,this.tags,n),n}return!0},showMarkers:function(){var t=this;if(!this.map)return!1;this.markerClusterGroup&&(this.map.removeLayer(this.markerClusterGroup),this.markerClusterGroup=void 0),this.markerClusterGroup=a["markerClusterGroup"]({iconCreateFunction:function(t){return a["divIcon"]({html:"<b>"+t.getChildCount()+"</b>",iconSize:new a["Point"](35,35)})},singleMarkerMode:!0,spiderfyOnMaxZoom:!1,showCoverageOnHover:!1,zoomToBoundsOnClick:!1}),this.itemsToShow.forEach((function(e){var n=a["marker"]([e.coordinates.lat,e.coordinates.lng],{index:e.index}).on("click",(function(e){if(t.items[e.sourceTarget.options.index]){t.itemsToShowInPopUp=[t.items[e.sourceTarget.options.index]];var n=t.items[e.sourceTarget.options.index].coordinates;t.popupMapCenter=[n.lat,n.lng]}else console.log("wrong index")}));t.markerClusterGroup.addLayer(n)})),this.markerClusterGroup.on("clusterclick",(function(e){var n=e.layer.getAllChildMarkers(),o=[];n.forEach((function(e){t.items[e.options.index]?o.push(t.items[e.options.index]):console.log("wrong index")})),t.itemsToShowInPopUp=t.shuffle(o),t.popupMapCenter=[e.latlng.lat,e.latlng.lng]})),this.map.addLayer(this.markerClusterGroup),this.markerClusterGroup.refreshClusters()},init:function(){var t=this;this.get(this.config.geoJSONPath,(function(e){t.geoJson=t.validateJsonString(e),t.geoJson&&(console.log(t.geoJson),t.initMap())})),this.get(this.config.CSVPath,(function(e){var n,o=r["parse"](e),s=[];if(o){for(var i=1;i<o.data.length;i++)n=o.data[i],s.push({index:i-1,name:n[0],age:n[1],location:n[2],region:n[3],coordinates:{lng:parseFloat(n[4]),lat:parseFloat(n[5])},themeTags:n[6],photoURL:n[7],youtubeURL:n[8],text:n[9],callToAction:{url:n[10],text:n[11]}});t.items=s,t.itemsToShow=t.items}}))},initMap:function(){this.map=a["map"]("map",{maxZoom:this.maxZoom,minZoom:0,continuousWorld:!0,scrollWheelZoom:!1,static:!0}).setView([53.943,-2.438],6),a["geoJson"](this.geoJson,{clickable:!0}).addTo(this.map),this.itemsToShow.length>0&&this.showMarkers()},getRandomLatLng:function(){return{lat:50.44351305245807+6.728478929685778*Math.random(),lng:14.414062500000004*Math.random()-9.645996093750002}},shuffle:function(t){var e,n,o=t.length;while(0!==o)n=Math.floor(Math.random()*o),o-=1,e=t[o],t[o]=t[n],t[n]=e;return t},get:function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&200===n.status&&e(n.responseText)},n.open("GET",t,!0),n.send()},validateJsonString:function(t){var e=!1;try{e=JSON.parse(t)}catch(n){return!1}return e}}},M=L,O=(n("034f"),Object(p["a"])(M,s,i,!1,null,null,null)),P=O.exports,J=n("e0ec"),U=n.n(J);o["a"].config.productionTip=!1,o["a"].use(U.a),new o["a"]({render:function(t){return t(P)}}).$mount("#app")},"65f01":function(t,e,n){"use strict";var o=n("f725"),s=n.n(o);s.a},"85ec":function(t,e,n){},"8be2":function(t,e,n){},be1a:function(t,e,n){},e7e9:function(t,e,n){"use strict";var o=n("8be2"),s=n.n(o);s.a},f725:function(t,e,n){}});
//# sourceMappingURL=app.59b4c9e7.js.map